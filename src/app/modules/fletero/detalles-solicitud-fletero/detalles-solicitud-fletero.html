<div
  class="flex flex-col flex-grow items-center justify-start w-full max-w-4xl mx-auto bg-white shadow-lg rounded-lg overflow-hidden"
>
  <!-- Top bar -->
  <header
    class="w-full bg-primary-orange p-4 flex items-center justify-between rounded-t-lg shadow-md"
  >
    <div class="flex items-center">
      <button
        id="backButton"
        class="text-white text-2xl mr-4 focus:outline-none"
      >
        <i class="fas fa-arrow-left"></i>
      </button>
      <h1 class="text-white text-xl font-semibold">Realizar cotización</h1>
    </div>
    <button class="text-white text-2xl focus:outline-none">
      <i class="fas fa-user-circle"></i>
    </button>
  </header>

  <!-- Main content -->
  <main class="flex-grow flex flex-col p-6 w-full overflow-y-auto">
    <h2 class="text-blue-gray-dark text-2xl font-bold mb-6 text-center">
      Detalles de la Solicitud
    </h2>

    <!-- Loading / Error -->
    <div *ngIf="loading" class="text-center py-6">Cargando solicitud...</div>
    <div *ngIf="error && !loading" class="text-center text-red-600 py-6">
      No se pudo cargar la solicitud.
    </div>

    <ng-container *ngIf="pedido && !loading">
      <!-- Request Details Section -->
      <div
        class="bg-white p-4 rounded-xl shadow-md border border-gray-200 mb-6"
      >
        <h3 class="text-blue-gray-dark text-xl font-semibold mb-3">
          Información del Flete
        </h3>
        <p class="text-gray-700 mb-1">
          <span class="font-medium">Origen:</span>
          {{ pedido.direccion_origen }}
          <span *ngIf="pedido.localidad_origen"
            >, {{ pedido.localidad_origen.nombre }}</span
          >
        </p>
        <p class="text-gray-700 mb-1">
          <span class="font-medium">Destino:</span>
          {{ pedido.direccion_destino }}
        </p>
        <!-- Si tenés dimensiones/peso en 'detalles_carga' podés parsearlo; dejo placeholders cuando no existe -->
        <p class="text-gray-700 mb-1">
          <span class="font-medium">Dimensiones:</span>
          {{
            pedido.detalles_carga
              ? (pedido.detalles_carga | slice: 0 : 40)
              : "---"
          }}
        </p>
        <p class="text-gray-700 mb-1">
          <span class="font-medium">Peso:</span>
          {{ pedido.detalles_carga ? "ver detalles" : "---" }}
        </p>
        <p class="text-gray-700 mb-1">
          <span class="font-medium">Medidas:</span>
          {{ pedido.medidas ? "ver detalles" : "---" }}
        </p>
        <p class="text-gray-700 mb-3">
          <span class="font-medium">Fecha/Hora Recogida:</span>
          {{ pedido.hora_recogida | date: "dd/MM/yyyy HH:mm" }}
        </p>

        <h4 class="text-blue-gray-dark text-lg font-semibold mb-2">
          Fotos de la Carga:
        </h4>
        <div class="flex flex-wrap gap-2 mb-2">
          <!-- Si tenés URLs en la entidad, iteralas; dejo placeholders si no -->
          <img
            *ngFor="let i of [1, 2, 3]"
            src="foto_pedido.png"
            alt="Carga Foto"
            class="w-20 h-20 object-cover rounded-lg border border-gray-300"
          />
        </div>
      </div>

      <!-- Client Information Section -->
      <div
        class="bg-white p-4 rounded-xl shadow-md border border-gray-200 mb-6"
      >
        <h3 class="text-blue-gray-dark text-xl font-semibold mb-3">
          Información del Cliente
        </h3>
        <div class="flex items-center">
          <img
            src="boy.png"
            alt="Perfil Cliente"
            class="w-16 h-16 rounded-full object-cover mr-4 border border-gray-300"
          />
          <div>
            <p class="text-blue-gray-dark text-lg font-medium">
              {{ pedido.cliente?.nombre || "Nombre del Cliente" }}
              {{ pedido.cliente?.apellido || "" }}
            </p>
            <p class="text-gray-600 text-sm">{{ pedido.cliente?.email }}</p>
            <p class="text-gray-600 text-sm">{{ pedido.cliente?.telefono }}</p>
          </div>
        </div>
      </div>

      <!-- Quote Form Section -->
      <div
        class="bg-white p-4 rounded-xl shadow-md border border-gray-200 mb-6"
      >
        <h3 class="text-blue-gray-dark text-xl font-semibold mb-3">
          Realizar Cotización
        </h3>
        <form
          (ngSubmit)="submitQuote()"
          #quoteForm="ngForm"
          class="space-y-4"
          novalidate
        >
          <div>
            <label
              for="price"
              class="block text-blue-gray-dark text-sm font-medium mb-1"
              >Precio de la Cotización (ARS)</label
            >
            <input
              type="number"
              id="price"
              name="price"
              placeholder="Ej: 5000"
              class="w-full p-3 border border-gray-300 rounded-lg focus-ring-primary-orange text-blue-gray-dark"
              required
              [(ngModel)]="quote.price"
              #price="ngModel"
            />
            <div
              *ngIf="price.invalid && price.touched"
              class="text-red-600 text-sm mt-1"
            >
              El precio es requerido.
            </div>
          </div>
          <div>
            <label
              for="notes"
              class="block text-blue-gray-dark text-sm font-medium mb-1"
              >Notas breves (opcional)</label
            >
            <textarea
              id="notes"
              name="notes"
              rows="3"
              placeholder="Ej: El precio incluye peajes."
              class="w-full p-3 border border-gray-300 rounded-lg focus-ring-primary-orange text-blue-gray-dark"
              [(ngModel)]="quote.notes"
            ></textarea>
          </div>
          <div class="flex justify-around mt-6 space-x-4">
            <button
              type="button"
              (click)="cancelQuote()"
              class="w-1/2 py-3 px-6 bg-white text-blue-gray-dark border border-blue-gray-dark rounded-xl shadow-md text-lg font-bold transform transition duration-300 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-gray-dark focus:ring-opacity-75"
            >
              Cancelar
            </button>
            <button
              type="submit"
              [disabled]="quoteForm.invalid"
              class="w-1/2 py-3 px-6 bg-secondary-orange text-white rounded-xl shadow-md text-lg font-bold transform transition duration-300 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary-orange focus:ring-opacity-75"
            >
              Enviar Cotización
            </button>
          </div>
        </form>
      </div>
    </ng-container>
  </main>

  <!-- Footer -->
  <footer
    class="w-full bg-blue-gray-dark p-3 text-center text-white text-sm rounded-b-lg"
  >
    &copy; 2025 Fletway. Todos los derechos reservados.
  </footer>
</div>
